let fs = require('fs')
let stringify = require('./stringify')
let user = require("../out/amirh.json")
let stopWords = [
"!",
"",
"#",
"(",
")",
"*",
"\"",
"-",
".",
"/",
":",
"[",
"]",
"ยซ",
"ยป",
"ุ",
"ุ",
"ุ",
"ฐ",
"ฑ",
"ฒ",
"ณ",
"ด",
"ต",
"ถ",
"ท",
"ธ",
"น",
"โฆ",
"$",
"ุฏฺฏุฑุงู",
"ููฺูุงู",
"ูุฏุช",
"ฺุฒ",
"ุณุงุฑ",
"ุฌุง",
"ุท",
"ฺฉู",
"ฺฉููู",
"ุจุฑูู",
"ูุซูุง",
"ฺฉุงูู",
"ฺฉุงููุง",
"ุขูฺฉู",
"ููุงุฑุฏ",
"ูุงูุน",
"ุงููุฑ",
"ุงฺฉููู",
"ุจุทูุฑ",
"ุจุฎุด",
"ุชุญุช",
"ฺฺฏููู",
"ุนุฏู",
"ููุน",
"ุญุงุถุฑ",
"ูุถุน",
"ููุงุจู",
"ฺฉูุงุฑ",
"ุฎูุด",
"ูฺฏุงู",
"ุฏุฑูู",
"ุฒูุงู",
"ุจูุงุจุฑุงู",
"ุชู",
"ุฎู",
"ุจุฒุฑฺฏ",
"ุฎูุฏุด",
"ุฌุฒ",
"ุงูุฌุง",
"ูุฎุชูู",
"ุชูุณุท",
"ููุน",
"ููฺูู",
"ุขูุฌุง",
"ูุจู",
"ุฌูุงุญ",
"ุงููุง",
"ุทูุฑ",
"ุดุงุฏ",
"ุงุดุงู",
"ุฌูุช",
"ุทุฑู",
"ูุงููุฏ",
"ูพุฏุง",
"ููฺฉู",
"ฺฉุณุงู",
"ุฌุง",
"ฺฉุณ",
"ุบุฑ",
"ุจ",
"ูุงุจู",
"ุฏุฑุจุงุฑู",
"ุฌุฏุฏ",
"ููุช",
"ุงุฎุฑ",
"ฺุฑุง",
"ุจุด",
"ุฑู",
"ุทุฑู",
"ุฌุฑุงู",
"ุฒุฑ",
"ุขูฺู",
"ุงูุจุชู",
"ููุท",
"ฺุฒ",
"ฺูู",
"ุจุฑุงุจุฑ",
"ูููุฒ",
"ุจุฎุด",
"ุฒููู",
"ุจู",
"ุจุฏูู",
"ุงุณุชูุงุฏ",
"ููุงู",
"ูุดุงู",
"ุจุณุงุฑ",
"ุจุนุฏ",
"ุนูู",
"ุฑูุฒ",
"ุงุนูุงู",
"ฺูุฏ",
"ุขูุงู",
"ุจูฺฉู",
"ุงูุฑูุฒ",
"ุชูุงู",
"ุจุดุชุฑ",
"ุขุง",
"ุจุฑุฎ",
"ุนูู",
"ุฏฺฏุฑ",
"ูฺู",
"ฺฏุฐุดุชู",
"ุงูุฌุงู",
"ุญุช",
"ุฏุงุฏู",
"ุฑุงู",
"ุณู",
"ูู",
"ุฒูุงู",
"ุญุงู",
"ุชููุง",
"ุจุณุงุฑ",
"ุนู",
"ุนููุงู",
"ููู",
"ูุจฺ",
"ูพุด",
"ู",
"ฺฉ",
"ุงูฺฉู",
"ูุฌูุฏ",
"ุดูุง",
"ูพุณ",
"ฺูู",
"ูุงู",
"ููุฑุฏ",
"ฺู",
"ุงฺฏุฑ",
"ููู",
"ูู",
"ุฏฺฏุฑ",
"ุขููุง",
"ุจุงุฏ",
"ูุฑ",
"ุงู",
"ูุง",
"ูู",
"ุชุง",
"ูุฒ",
"ุงูุง",
"ฺฉ",
"ุฎูุฏ",
"ุจุฑ",
"ุง",
"ูู",
"ุฑุง",
"ุงู",
"ุจุง",
"ุขู",
"ุจุฑุง",
"ู",
"ุฏุฑ",
"ุจู",
"ฺฉู",
"ุงุฒ",
"ุชุฑู",
"",
" "
]
let memorial = []
for (let post of user.posts){
    let count = post.body.length + post.title.length
    let text = post.body
    let tokens = text.replace(/[ุ.,\/#!$%\^&\*;:{}=\-_`~()\n\r]|[๐๐๐๐โ\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2694-\u2697]|\uD83E[\uDD10-\uDD5D]/g,"").split(" ")
    let dict = []
    for (let word of tokens){
        if (word !== undefined && !stopWords.hasOwnProperty(word)){
            if (dict.hasOwnProperty(word))
                dict[word] += 1
            else
                dict[word] = 1
        }
    }
    let mem = {
        author: post.user.username,
        title: post.title,
        length: count,
        dictionary: dict
    }
    memorial.push(mem)
}
console.log(memorial)
fs.writeFile('out/posts/'+user.username+'.json', stringify(memorial), 'utf8', function(err) {
    if (err) throw err;
    console.log('complete!' );
});
